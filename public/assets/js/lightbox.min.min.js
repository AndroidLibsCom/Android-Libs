(function(){var e=jQuery,d=function(){function b(){this.fadeDuration=500,this.fitImagesInViewport=!0,this.resizeDuration=700,this.positionFromTop=50,this.showImageNumberLabel=!0,this.alwaysShowNavOnTouchDevices=!1,this.wrapAround=!1}return b.prototype.albumLabel=function(g,c){return"Image "+g+" of "+c},b}(),f=function(){function a(b){this.options=b,this.album=[],this.currentImageIndex=void 0,this.init()}return a.prototype.init=function(){this.enable(),this.build()},a.prototype.enable=function(){var c=this;e("body").on("click","a[rel^=lightbox], area[rel^=lightbox], a[data-lightbox], area[data-lightbox]",function(b){return c.start(e(b.currentTarget)),!1})},a.prototype.build=function(){var c=this;e("<div id='lightboxOverlay' class='lightboxOverlay'></div><div id='lightbox' class='lightbox'><div class='lb-outerContainer'><div class='lb-container'><img class='lb-image' src='' /><div class='lb-nav'><a class='lb-prev' href='' ></a><a class='lb-next' href='' ></a></div><div class='lb-loader'><a class='lb-cancel'></a></div></div></div><div class='lb-dataContainer'><div class='lb-data'><div class='lb-details'><span class='lb-caption'></span><span class='lb-number'></span></div><div class='lb-closeContainer'><a class='lb-close'></a></div></div></div></div>").appendTo(e("body")),this.$lightbox=e("#lightbox"),this.$overlay=e("#lightboxOverlay"),this.$outerContainer=this.$lightbox.find(".lb-outerContainer"),this.$container=this.$lightbox.find(".lb-container"),this.containerTopPadding=parseInt(this.$container.css("padding-top"),10),this.containerRightPadding=parseInt(this.$container.css("padding-right"),10),this.containerBottomPadding=parseInt(this.$container.css("padding-bottom"),10),this.containerLeftPadding=parseInt(this.$container.css("padding-left"),10),this.$overlay.hide().on("click",function(){return c.end(),!1}),this.$lightbox.hide().on("click",function(b){return"lightbox"===e(b.target).attr("id")&&c.end(),!1}),this.$outerContainer.on("click",function(b){return"lightbox"===e(b.target).attr("id")&&c.end(),!1}),this.$lightbox.find(".lb-prev").on("click",function(){return c.changeImage(0===c.currentImageIndex?c.album.length-1:c.currentImageIndex-1),!1}),this.$lightbox.find(".lb-next").on("click",function(){return c.changeImage(c.currentImageIndex===c.album.length-1?0:c.currentImageIndex+1),!1}),this.$lightbox.find(".lb-loader, .lb-close").on("click",function(){return c.end(),!1})},a.prototype.start=function(w){function v(b){u.album.push({link:b.attr("href"),title:b.attr("data-title")||b.attr("title")})}var u=this,t=e(window);t.on("resize",e.proxy(this.sizeOverlay,this)),e("select, object, embed").css({visibility:"hidden"}),this.sizeOverlay(),this.album=[];var s,r=0,q=w.attr("data-lightbox");if(q){s=e(w.prop("tagName")+'[data-lightbox="'+q+'"]');for(var p=0;p<s.length;p=++p){v(e(s[p])),s[p]===w[0]&&(r=p)}}else{if("lightbox"===w.attr("rel")){v(w)}else{s=e(w.prop("tagName")+'[rel="'+w.attr("rel")+'"]');for(var o=0;o<s.length;o=++o){v(e(s[o])),s[o]===w[0]&&(r=o)}}}var n=t.scrollTop()+this.options.positionFromTop,m=t.scrollLeft();this.$lightbox.css({top:n+"px",left:m+"px"}).fadeIn(this.options.fadeDuration),this.changeImage(r)},a.prototype.changeImage=function(g){var j=this;this.disableKeyboardNav();var i=this.$lightbox.find(".lb-image");this.$overlay.fadeIn(this.options.fadeDuration),e(".lb-loader").fadeIn("slow"),this.$lightbox.find(".lb-image, .lb-nav, .lb-prev, .lb-next, .lb-dataContainer, .lb-numbers, .lb-caption").hide(),this.$outerContainer.addClass("animating");var h=new Image;h.onload=function(){var q,p,o,n,m,c,b;i.attr("src",j.album[g].link),q=e(h),i.width(h.width),i.height(h.height),j.options.fitImagesInViewport&&(b=e(window).width(),c=e(window).height(),m=b-j.containerLeftPadding-j.containerRightPadding-20,n=c-j.containerTopPadding-j.containerBottomPadding-120,(h.width>m||h.height>n)&&(h.width/m>h.height/n?(o=m,p=parseInt(h.height/(h.width/o),10),i.width(o),i.height(p)):(p=n,o=parseInt(h.width/(h.height/p),10),i.width(o),i.height(p)))),j.sizeContainer(i.width(),i.height())},h.src=this.album[g].link,this.currentImageIndex=g},a.prototype.sizeOverlay=function(){this.$overlay.width(e(window).width()).height(e(document).height())},a.prototype.sizeContainer=function(j,i){function p(){o.$lightbox.find(".lb-dataContainer").width(l),o.$lightbox.find(".lb-prevLink").height(k),o.$lightbox.find(".lb-nextLink").height(k),o.showImage()}var o=this,n=this.$outerContainer.outerWidth(),m=this.$outerContainer.outerHeight(),l=j+this.containerLeftPadding+this.containerRightPadding,k=i+this.containerTopPadding+this.containerBottomPadding;n!==l||m!==k?this.$outerContainer.animate({width:l,height:k},this.options.resizeDuration,"swing",function(){p()}):p()},a.prototype.showImage=function(){this.$lightbox.find(".lb-loader").hide(),this.$lightbox.find(".lb-image").fadeIn("slow"),this.updateNav(),this.updateDetails(),this.preloadNeighboringImages(),this.enableKeyboardNav()},a.prototype.updateNav=function(){var g=!1;try{document.createEvent("TouchEvent"),g=this.options.alwaysShowNavOnTouchDevices?!0:!1}catch(c){}this.$lightbox.find(".lb-nav").show(),this.album.length>1&&(this.options.wrapAround?(g&&this.$lightbox.find(".lb-prev, .lb-next").css("opacity","1"),this.$lightbox.find(".lb-prev, .lb-next").show()):(this.currentImageIndex>0&&(this.$lightbox.find(".lb-prev").show(),g&&this.$lightbox.find(".lb-prev").css("opacity","1")),this.currentImageIndex<this.album.length-1&&(this.$lightbox.find(".lb-next").show(),g&&this.$lightbox.find(".lb-next").css("opacity","1"))))},a.prototype.updateDetails=function(){var c=this;"undefined"!=typeof this.album[this.currentImageIndex].title&&""!==this.album[this.currentImageIndex].title&&this.$lightbox.find(".lb-caption").html(this.album[this.currentImageIndex].title).fadeIn("fast").find("a").on("click",function(){location.href=e(this).attr("href")}),this.album.length>1&&this.options.showImageNumberLabel?this.$lightbox.find(".lb-number").text(this.options.albumLabel(this.currentImageIndex+1,this.album.length)).fadeIn("fast"):this.$lightbox.find(".lb-number").hide(),this.$outerContainer.removeClass("animating"),this.$lightbox.find(".lb-dataContainer").fadeIn(this.options.resizeDuration,function(){return c.sizeOverlay()})},a.prototype.preloadNeighboringImages=function(){if(this.album.length>this.currentImageIndex+1){var g=new Image;g.src=this.album[this.currentImageIndex+1].link}if(this.currentImageIndex>0){var c=new Image;c.src=this.album[this.currentImageIndex-1].link}},a.prototype.enableKeyboardNav=function(){e(document).on("keyup.keyboard",e.proxy(this.keyboardAction,this))},a.prototype.disableKeyboardNav=function(){e(document).off(".keyboard")},a.prototype.keyboardAction=function(h){var g=27,l=37,k=39,j=h.keyCode,i=String.fromCharCode(j).toLowerCase();j===g||i.match(/x|o|c/)?this.end():"p"===i||j===l?0!==this.currentImageIndex?this.changeImage(this.currentImageIndex-1):this.options.wrapAround&&this.album.length>1&&this.changeImage(this.album.length-1):("n"===i||j===k)&&(this.currentImageIndex!==this.album.length-1?this.changeImage(this.currentImageIndex+1):this.options.wrapAround&&this.album.length>1&&this.changeImage(0))},a.prototype.end=function(){this.disableKeyboardNav(),e(window).off("resize",this.sizeOverlay),this.$lightbox.fadeOut(this.options.fadeDuration),this.$overlay.fadeOut(this.options.fadeDuration),e("select, object, embed").css({visibility:"visible"})},a}();e(function(){var b=new d;new f(b)})}).call(this);